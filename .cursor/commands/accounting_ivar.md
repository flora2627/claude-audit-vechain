**角色**: 你是一位顶级的DeFi协议安全建模专家，精通会计学和分布式系统。

**目标**: 为一个给定的DeFi协议，构建一个全面的、基于多主体的会计模型。你的核心任务是识别并明确定义所有**主体内部**和**跨主体之间**必须恒久成立的会计恒等式，以此来评估协议的经济安全性和状态一致性，特别是要能揭示因信任关系被利用而产生的“凭证伪造”风险。

**输入**: @Objective.md

**执行步骤**:

**第一步：识别核心会计主体 (Identify Core Accounting Entities)**

*   首先，通读协议资料，识别出所有独立管理价值状态（如代币、债务、债权、衍生品等）的核心智能合约。将它们定义为独立的“会计主体”。
*   **产出**: 一个清晰的主体列表，例如：主体A (`CLOB.sol`), 主体B (`AccountManager.sol`), 主体C (`Distributor.sol`)。

**第二步：为每个主体建立内部会计模型 (Model Intra-Entity Ledgers)**

*   对于在第一步中识别出的**每一个**主体，独立分析并建立其内部的微观会计模型。
*   具体操作：
    1.  **定义资产 (Assets)**: 列出该主体控制或持有的所有价值。
    2.  **定义负债和权益 (Liabilities & Equity)**: 列出该主体对外部（用户或其他合约）的所有义务。
    3.  **声明“主体内会计恒等式”**: 写出该主体内部必须时刻保持平衡的核心等式。这通常是 `资产 = 负债 + 权益` 的变体。
*   **产出**: 为每个主体生成一个独立的会计模型概要。

**第三步：系统性地映射跨主体交互并定义“跨主体会计恒等式”**

*   这是最关键的一步。你需要识别出连接不同主体的价值流动和状态依赖关系。
*   具体操作：
    1.  **生成交互组合**: 列出所有可能的实体交互组合。如果存在A, B, C三个主体，你需要分析的组合包括：(A, B), (A, C), (B, C), 以及 (A, B, C)。
    2.  **寻找“控制账户”**: 在一个主体的账本中，寻找代表其与另一个主体之间债权/债务关系的“中间科目”或“控制账户”。（例如，`AccountManager` 为 `CLOB` 维护的托管资金总额）。
    3.  **声明“跨主体会计恒等式”**: 对于每一个交互组合，定义一个或多个必须恒成立的数学等式。这个等式将不同主体的状态变量联系在一起，确保它们之间价值守恒。**这个恒等式就是用来检测“伪造凭证”的照妖镜。**

*   **产出**: 一个“跨主体会计恒等式”的清单，按交互组合进行分类。这是整个分析的核心。

**第四步：将关键操作建模为复式记账分录 (Model Key Operations as Double-Entry Transactions)**

*   选择协议中几个最核心的业务功能（如 `placeOrder`, `amendOrder`, `deposit`, `withdraw`）。
*   将每一个功能的操作流程，以跨主体的复式记账分录形式进行描述。清晰地展示一笔交易是如何在**所有相关主体**的账本上同时产生借方和贷方变化的。
*   **产出**: 几个关键操作的详细会计分录，直观地展示价值如何在多主体系统中联动和流转。

**最终输出格式**:

请将你的分析结果以下列结构化格式呈现：

```markdown
# [协议名称] 多主体会计安全模型

## 1. 核心会计主体识别

*   **主体A**: `[合约名称.sol]` - [主体功能简介]
*   **主体B**: `[合约名称.sol]` - [主体功能简介]
*   ...

## 2. 主体内部会计模型

### 2.1 主体A: `[合约名称.sol]`
*   **资产**:
    *   ...
*   **负债/权益**:
    *   ...
*   **[!] 主体内会计恒等式**: `[数学表达式]`

### 2.2 主体B: `[合约名称.sol]`
*   ...

## 3. 跨主体会计恒等式 (核心风险点)

### 3.1 交互对: (主体A <> 主体B)
*   **依赖关系描述**: [简述A和B如何交互，价值如何依赖]
*   **[!!] 跨主体恒等式 1**: `[连接A和B状态的数学表达式]`
*   **风险场景**: 如果此恒等式被破坏，意味着 [描述可能发生的风险，如A伪造凭证从B处无成本地提取价值]。

### 3.2 交互对: (主体A <> 主体C)
*   ...

### 3.3 交互组合: (主体A <> 主体B <> 主体C)
*   ...

## 4. 关键操作的复式记账分析

### 4.1 操作: `functionName()`
*   **业务描述**: [该操作的业务逻辑]
*   **会计分录**:
    *   **主体A账本**:
        *   借 (Debit): ...
        *   贷 (Credit): ...
    *   **主体B账本**:
        *   借 (Debit): ...
        *   贷 (Credit): ...
    *   **对账检查**: 此操作后，相关的跨主体恒等式 `[恒等式名称]` 是否依然成立。

---
```

最终结果保存到acc_modeling/account_ivar.md